<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qurany - إذاعات القرآن الكريم</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            scroll-behavior: smooth;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #0575E6, #021B79);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .station-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        /* Custom scrollbar for a more modern look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        /* Style for the volume slider */
        input[type=range] {
          -webkit-appearance: none;
          appearance: none;
          width: 100%;
          cursor: pointer;
          background: transparent;
        }
        input[type=range]:focus {
          outline: none;
        }
        /* For Chrome/Safari */
        input[type=range]::-webkit-slider-runnable-track {
          height: 6px;
          background: rgba(255, 255, 255, 0.3);
          border-radius: 3px;
        }
        input[type=range]::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          margin-top: -5px; /* Centers thumb on track */
          height: 16px;
          width: 16px;
          background: #ffffff;
          border-radius: 50%;
          box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
         /* For Firefox */
        input[type=range]::-moz-range-track {
          height: 6px;
          background: rgba(255, 255, 255, 0.3);
          border-radius: 3px;
        }
        input[type=range]::-moz-range-thumb {
          height: 16px;
          width: 16px;
          background: #ffffff;
          border-radius: 50%;
          border: none;
           box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body class="gradient-bg text-white">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold">Qurany</h1>
            <p class="text-lg text-gray-300 mt-2">استمع إلى تلاوات عطرة وإذاعات القرآن الكريم من كل مكان</p>
        </header>

        <!-- Main Player -->
        <main id="player" class="glass-card rounded-2xl p-6 md:p-8 shadow-2xl sticky top-4 z-10">
            <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                <!-- Play Button -->
                <button id="playPauseBtn" class="w-20 h-20 rounded-full bg-white text-blue-700 flex items-center justify-center shadow-lg transform hover:scale-105 transition-transform focus:outline-none focus:ring-4 focus:ring-white/50 flex-shrink-0">
                    <!-- Play Icon -->
                    <svg id="playIcon" class="w-10 h-10" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"></path>
                    </svg>
                    <!-- Pause Icon -->
                    <svg id="pauseIcon" class="w-10 h-10 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
                    </svg>
                </button>

                <!-- Station Info & Volume -->
                <div class="w-full text-center md:text-right">
                    <p class="text-gray-300 text-sm">تستمع الآن إلى</p>
                    <h2 id="stationName" class="text-2xl font-semibold truncate" title="لم يتم تحديد إذاعة">اختر إذاعة للبدء</h2>
                    <div class="flex items-center mt-3 gap-3 w-full max-w-xs mx-auto md:mx-0">
                        <!-- Volume Icon -->
                        <svg class="w-6 h-6 text-gray-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path></svg>
                        <!-- Volume Slider -->
                        <input id="volumeSlider" type="range" min="0" max="1" step="0.01" value="1" class="w-full">
                    </div>
                </div>
            </div>
            <audio id="audioPlayer" preload="none"></audio>
        </main>

        <!-- Stations List -->
        <section class="mt-8">
            <h3 class="text-3xl font-bold mb-6 text-center">قائمة الإذاعات</h3>
            
            <!-- Loading Spinner -->
            <div id="loading" class="text-center py-10">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"></div>
                <p class="mt-4 text-gray-300">جاري تحميل الإذاعات...</p>
            </div>
            
            <!-- Grid for stations -->
            <div id="stationsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Station items will be inserted here by JavaScript -->
            </div>
        </section>
        
        <!-- Footer -->
        <footer class="text-center mt-12 text-gray-400">
            <p>تم التطوير بحب ❤️</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const audioPlayer = document.getElementById('audioPlayer');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const playIcon = document.getElementById('playIcon');
            const pauseIcon = document.getElementById('pauseIcon');
            const volumeSlider = document.getElementById('volumeSlider');
            const stationNameDisplay = document.getElementById('stationName');
            const stationsGrid = document.getElementById('stationsGrid');
            const loadingIndicator = document.getElementById('loading');

            let isPlaying = false;
            let currentStationElement = null;

            const stations = [
                {
                    name: "إذاعة القرآن الكريم من القاهرة",
                    url: "https://n11.radiojar.com/8s5u5tpdtwzuv?fbclid=IwY2xjawM6OeVleHRuA2FlbQIxMABicmlkETFNajFoMGUzZ2t5REpPNGp4AR6URX5qMl2_VoiiiLmiiJ4XQ8pG1D_y_2U-YlDwvjNYxgZs0ac6tUVydTBNyQ_aem_08qWAXkHwkhkMRqpZINm4Q&listening-from-radio-garden=1624623936350&rj-ttl=5&rj-tok=AAABmWIzBB4AVV7wt3JbNa71vQ"
                }
            ];

            // --- Player Controls ---

            function togglePlayPause() {
                if (audioPlayer.src) {
                    if (isPlaying) {
                        audioPlayer.pause();
                    } else {
                        audioPlayer.play().catch(error => console.error("Playback error:", error));
                    }
                } else {
                    // Simple feedback if no station is selected
                    stationNameDisplay.textContent = "الرجاء اختيار إذاعة أولاً";
                    stationNameDisplay.classList.add('text-red-400');
                    setTimeout(() => {
                        stationNameDisplay.textContent = "اختر إذاعة للبدء";
                        stationNameDisplay.classList.remove('text-red-400');
                    }, 2000);
                }
            }

            function updatePlayPauseIcon() {
                isPlaying = !audioPlayer.paused;
                playIcon.classList.toggle('hidden', isPlaying);
                pauseIcon.classList.toggle('hidden', !isPlaying);
            }

            playPauseBtn.addEventListener('click', togglePlayPause);
            audioPlayer.addEventListener('play', updatePlayPauseIcon);
            audioPlayer.addEventListener('pause', updatePlayPauseIcon);
            audioPlayer.addEventListener('volumechange', () => {
                volumeSlider.value = audioPlayer.volume;
            });

            volumeSlider.addEventListener('input', (e) => {
                audioPlayer.volume = e.target.value;
            });
            
            // --- Station Selection ---
            
            function playStation(name, url, element) {
                stationNameDisplay.textContent = name;
                stationNameDisplay.title = name;
                audioPlayer.src = url;
                audioPlayer.play().catch(error => console.error("Playback error:", error));
                
                // Update active station style
                if (currentStationElement) {
                    currentStationElement.classList.remove('bg-white', 'text-blue-700', 'font-bold');
                    currentStationElement.classList.add('glass-card');
                }
                element.classList.add('bg-white', 'text-blue-700', 'font-bold');
                element.classList.remove('glass-card');
                currentStationElement = element;
            }

            // --- API Fetching and Rendering ---

            function renderStations(stationList) {
                stationsGrid.innerHTML = ''; // Clear previous content
                stationList.forEach(station => {
                    const stationDiv = document.createElement('div');
                    stationDiv.className = 'station-item glass-card rounded-lg p-4 cursor-pointer transition-all duration-300';
                    stationDiv.textContent = station.name;
                    stationDiv.setAttribute('data-url', station.url);
                    
                    stationDiv.addEventListener('click', () => {
                        playStation(station.name, station.url, stationDiv);
                    });
                    
                    stationsGrid.appendChild(stationDiv);
                });
            }

            async function fetchStations() {
                try {
                    const response = await fetch('https://www.mp3quran.net/api/v3/radios');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    // Format API data and combine with the static station
                    const apiStations = data.radios.map(radio => ({
                        name: radio.name,
                        url: radio.url
                    }));
                    
                    const allStations = [...stations, ...apiStations];
                    renderStations(allStations);

                } catch (error) {
                    console.error("Failed to fetch stations:", error);
                    // Render only the default station on error
                    renderStations(stations); 
                    stationsGrid.insertAdjacentHTML('beforeend', `<p class="text-center text-red-300 col-span-full">حدث خطأ أثناء تحميل الإذاعات الإضافية.</p>`);
                } finally {
                    loadingIndicator.style.display = 'none';
                }
            }

            fetchStations();
        });
    </script>

</body>
</html>
